(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a(50)},36:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),l=a.n(c),o=(a(36),a(5)),s=a(3),i=a(12),u=a(6),m=function(e){var t=e.name,a=e.image,n=e.subCategories,c=e.isSubCategory,l=e._id,s=e.goods;return r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"".concat(!1===c?"border":"")},r.a.createElement(o.b,{to:"/".concat(c?"subcategory":"category","/").concat(l),className:c?"":"font-weight-bolder"},t," ",s?s.length:0),!1===c&&null!==a?r.a.createElement("img",{src:a,alt:t}):null,r.a.createElement(p,{categories:null===n?[]:n,isSubCategory:null!==n})))};m.defaultProps={subCategories:[],isSubCategory:!1};var d=m,g=function(e){var t=e.categories,a=e.isSubCategory;return r.a.createElement("div",{className:"row"},t.map(function(e){return r.a.createElement(d,Object.assign({},e,{key:e._id,isSubCategory:a}))}))};g.defaultProps={isSubCategory:!1};var p=g,v=function(){return r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))},E=a(10),f=a(2),b=a(4),y="http://shop-roles.asmer.fs.a-level.com.ua",h="".concat(y,"/graphql"),N=new b.GraphQLClient(h),O=localStorage.getItem("token");null!==O&&(console.log("token",O),N.setHeader("Authorization","Bearer ".concat(localStorage.getItem("token"))));var j=N;function S(e,t){switch(t.type){case"pending":return Object(f.a)(Object(f.a)({},e),{},{status:"pending"});case"resolved":return Object(f.a)(Object(f.a)({},e),{},{data:t.payload,status:"resolved"});case"rejected":return Object(f.a)(Object(f.a)({},e),{},{status:"rejected",error:t.error});default:throw new Error}}var w=function(e){var t=e.query,a=e.variables,n=void 0===a?{}:a,c=e.initialState,l=r.a.useReducer(S,c,function(e){return{error:null,status:"idle",data:e}}),o=Object(E.a)(l,2),s=o[0],i=o[1];return r.a.useEffect(function(){i({type:"pending"}),j.request(t,n).then(function(e){i({type:"resolved",payload:e})}).catch(function(e){console.log("e",e),i({type:"rejected",error:e})})},[]),s};function q(){var e=Object(u.a)(['\n  query {\n    CategoryFind(query: "[{}]") {\n      name\n      _id\n      subCategories {\n        name\n        _id\n        image {\n          url\n        }\n      }\n      image {\n        url\n      }\n    }\n  }\n']);return q=function(){return e},e}var C=Object(b.gql)(q()),k=function(){var e=w({query:C,initialState:{CategoryFind:[]}});e.data,e.status;return r.a.createElement("div",{className:"mt-3"},"Home screen",r.a.createElement("form",null,r.a.createElement("input",{onChange:function(e){var t=new FormData;t.append("photo",e.target.files[0]),fetch("".concat(y,"/upload"),{method:"POST",headers:localStorage.token?{Authorization:"Bearer "+localStorage.token}:{},body:t}).then(function(e){return e.json()}).then(function(e){return console.log("UPLOAD RESULT",e)})},type:"file",name:"photo",id:"photo"})))};function x(){var e=Object(u.a)(["\n  query getCategory($query: String) {\n    CategoryFindOne(query: $query) {\n      name\n      parent {\n        name\n      }\n      goods {\n        _id\n        price\n        name\n      }\n    }\n  }\n"]);return x=function(){return e},e}var L=Object(b.gql)(x()),F=function(){var e=Object(s.g)().id,t=w({initialState:{CategoryFindOne:{goods:[]}},query:L,variables:{query:JSON.stringify([{_id:e}])}}),a=t.data,n=t.status,c=a.CategoryFindOne,l=c.goods,o=null===c.parent?"Category":"Sub category";return r.a.createElement("div",null,r.a.createElement("h1",null,o," Screen: ",e),"pending"===n?r.a.createElement(v,null):null,r.a.createElement("ul",null,null===l?r.a.createElement("h2",null,"There is no data"):l.map(function(e){return r.a.createElement("li",{key:e._id},r.a.createElement("span",null,e.name),r.a.createElement("span",null,e.price))})))};function P(){var e=Object(u.a)(["\n  query categoryFind($query: String) {\n    CategoryFind(query: $query) {\n      name\n      _id\n    }\n  }\n"]);return P=function(){return e},e}var $=Object(b.gql)(P()),_=function(e){var t=e.status,a=e.noData,n=e.children;return"searching"===t?r.a.createElement(v,null):a?r.a.createElement("span",null,"No Data"):"idle"===t?r.a.createElement("span",{className:"my-3"},"Search data"):"resolved"===t?r.a.createElement("div",{className:"mt-3"},n):void 0},I=function(){var e=r.a.useState(null),t=Object(E.a)(e,2),a=t[0],n=t[1],c=r.a.useState("idle"),l=Object(E.a)(c,2),s=l[0],i=l[1];return r.a.createElement("div",{className:"Container"},r.a.createElement("h1",null,"\u041f\u043e\u0438\u0441\u043a \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),r.a.createElement("div",{className:"row"},r.a.createElement(o.b,{className:"col-sm-12 my-3",to:"/"},"Go Home")),r.a.createElement("div",{className:"row flex-sm-column align-items-sm-center"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{className:"form-control",type:"search",onChange:function(e){var t=new RegExp(e.target.value);i("searching"),j.request($,{query:JSON.stringify([{name:String(t)}])}).then(function(e){n(e.CategoryFind),i("resolved")},console.log)}})),r.a.createElement(_,{noData:null!==a&&0===a.length,status:s},r.a.createElement("div",null,JSON.stringify(a)))))},D=a(13);function R(){var e=Object(u.a)(["\n  query goodFind($query: String) {\n    GoodFind(query: $query) {\n      name\n      _id\n      images {\n        url\n      }\n      description\n    }\n  }\n"]);return R=function(){return e},e}var A=Object(b.gql)(R()),Q=function(e){var t=e.noData,a=e.status,n=e.children;return"searching"===a?r.a.createElement(v,null):t?r.a.createElement("div",null,"No Data"):"idle"===a?r.a.createElement("span",{className:"my-3"},"Search data"):"resolved"===a?r.a.createElement("div",{className:"row flex-sm-row mt-3"},n.props.children.map(function(e,t){return r.a.createElement("div",{className:"card col-sm-4 my-2 mx-5",key:t.toString()},e.images&&r.a.createElement("img",{src:e.images[0].url?"http://shop-roles.asmer.fs.a-level.com.ua/".concat(e.images[0].url):"http://",className:"card-img-top",alt:e._id}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},e.name),r.a.createElement("p",{className:"card-text"},e.description?e.description:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u041e\u0436\u0438\u0434\u0430\u0439\u0442\u0435"),r.a.createElement("a",{href:"#",className:"btn btn-primary"},"Go somewhere")))})):void 0},G=Object(i.b)(function(e){return{goodsQueryFromRedux:e.goods.goodsQuery}},function(e){return Object(D.b)({goodsQuery:function(e){return{type:"QUERY_RESOLVE",payload:e}}},e)})(r.a.memo(function(e){var t=r.a.useState(null),a=Object(E.a)(t,2),n=a[0],c=a[1],l=r.a.useState("idle"),s=Object(E.a)(l,2),i=s[0],u=s[1];return r.a.createElement("div",{className:"Container"},r.a.createElement("h1",null,"\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043f\u043e \u0432\u0441\u0435\u043c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c"),r.a.createElement("div",{className:"row"},r.a.createElement(o.b,{className:"col-sm-12 my-3",to:"/"},"Go Home")),r.a.createElement("div",{className:"row flex-sm-column align-items-sm-center"},r.a.createElement("div",{className:"col-sm-6"},r.a.createElement("input",{className:"form-control",type:"search",onChange:function(t){var a=new RegExp(t.target.value);u("searching"),j.request(A,{query:JSON.stringify([{name:String(a)}])}).then(function(t){c(t.GoodFind),e.goodsQuery(t.GoodFind),u("resolved")})}})),r.a.createElement(Q,{noData:null!==n&&0===n.length,status:i},r.a.createElement("div",null,n))))})),T=a(27),H=a.n(T),J=(a(47),{isLoggedIn:!!localStorage.getItem("token"),status:"idle"}),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;switch((arguments.length>1?arguments[1]:void 0).type){case"login/pending":return Object(f.a)(Object(f.a)({},e),{},{status:"pending"});case"login/resolved":return Object(f.a)(Object(f.a)({},e),{},{isLoggedIn:!0,status:"resolved"});case"login/rejected":return Object(f.a)(Object(f.a)({},e),{},{status:"rejected",isLoggedIn:!1});default:return e}},B=a(22),z=a.n(B),V=a(28);function Y(){var e=Object(u.a)(["\n  query auth($login: String!, $password: String!) {\n    login(login: $login, password: $password)\n  }\n"]);return Y=function(){return e},e}var K=Object(b.gql)(Y());function M(){var e=Object(u.a)(["\n  mutation create($login: String!, $password: String!, $nick: String!) {\n    UserUpsert(user: { login: $login, password: $password, nick: $nick }) {\n      login\n      nick\n    }\n  }\n"]);return M=function(){return e},e}var W=Object(b.gql)(M()),X=function(){var e=r.a.useState({}),t=Object(E.a)(e,2),a=t[0],n=t[1],c=function(e){var t=e.target;n(function(e){return Object(f.a)(Object(f.a)({},e),{},{[t.name]:t.value})})};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),j.request(W,a).then(console.log)}},r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{className:"col-sm-2 col-form-label"},"Login"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{type:"text",class:"form-control",placeholder:"Login",name:"login",onChange:c}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{class:"col-sm-2 col-form-label"},"Nick"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Nick",name:"nick",onChange:c}))),r.a.createElement("div",{className:"form-group row"},r.a.createElement("label",{class:"col-sm-2 col-form-label"},"Password"),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password",name:"password",onChange:c}))),r.a.createElement("button",{className:"btn btn-primary"},"Create"))},Z=function(e){var t=e.dispatch,a=r.a.useState({}),n=Object(E.a)(a,2),c=n[0],l=n[1],o=function(e){var t=e.target;l(function(e){return Object(f.a)(Object(f.a)({},e),{},{[t.name]:t.value})})};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(function(e){return function(){var t=Object(V.a)(z.a.mark(function t(a,n,r){var c,l;return z.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"login/pending"}),t.next=4,r.request(K,e);case 4:c=t.sent,l=c.login,console.log("login",l),null===l&&a({type:"login/rejected"}),localStorage.setItem("token",l),r.setHeader("Authorization","Bearer ".concat(l)),a({type:"login/resolved"}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),a({type:"login/rejected"});case 16:case"end":return t.stop()}},t,null,[[0,13]])}));return function(e,a,n){return t.apply(this,arguments)}}()}(c))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Login"),r.a.createElement("input",{name:"login",onChange:o,type:"text",className:"form-control",placeholder:"Login"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{onChange:o,name:"password",type:"password",className:"form-control",placeholder:"Password"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Create"))},ee=[{path:"/login",exact:!0,component:Object(i.b)(function(e){return{isLoggedIn:e.auth.isLoggedIn,authStatus:e.auth.status}})(function(e){var t=e.dispatch,a=e.authStatus,n=r.a.useState(!0),c=Object(E.a)(n,2),l=c[0],o=c[1];return"resolved"===a?r.a.createElement(s.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("div",{className:"d-flex align-items-center justify-content-center"},r.a.createElement("h1",null,l?"Login":"Registration"," "),r.a.createElement(H.a,{checked:l,onChange:function(e){return o(function(e){return!e})}})),r.a.createElement("div",{className:"col-sm-12 col-md-5 mx-auto"},l?r.a.createElement(Z,{dispatch:t}):r.a.createElement(X,null)),r.a.createElement("div",{className:"my-3"},"pending"===a?r.a.createElement(v,null):null),r.a.createElement("div",{className:"mt-2"},"rejected"===a?r.a.createElement("span",{className:"text-danger"},"Something went wrong"):null))}),isProtected:!1},{path:"/",exact:!0,component:k,isProtected:!0,redirectTo:"/login"},{path:"/category/search",exact:!0,component:I,isProtected:!0},{path:"/category/goods",exact:!0,component:G,isProtected:!0},{path:"/category/:id",exact:!0,component:F,isProtected:!0},{path:"/subcategory/:id",exact:!0,component:F,isProtected:!0},{children:function(){return r.a.createElement("div",null," Oops, not found")},isProtected:!1}],te={goodsQuery:null},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"QUERY_RESOLVE":return Object(f.a)(Object(f.a)({},e),{},{goodsQuery:t.payload});default:return e}},ne=Object(D.c)({auth:U,goods:ae}),re=a(29),ce=Object(D.d)(ne,Object(D.a)(re.a.withExtraArgument(j))),le=a(30),oe=function(e){var t=e.component,a=e.redirectTo,n=e.isAuth,c=Object(le.a)(e,["component","redirectTo","isAuth"]);return r.a.createElement(s.b,Object.assign({},c,{render:function(e){var c=e.location;return n?r.a.createElement(t,null):r.a.createElement(s.a,{to:{pathname:a,state:{from:c}}})}}))};oe.defaultProps={redirectTo:"/login"};var se=Object(i.b)(function(e){return{isAuth:e.auth.isLoggedIn}})(oe);function ie(){var e=Object(u.a)(['\n  query {\n    CategoryFind(query: "[{}]") {\n      name\n      _id\n      subCategories {\n        name\n        _id\n        image {\n          url\n        }\n      }\n      image {\n        url\n      }\n      goods {\n        name\n        _id\n        price\n      }\n    }\n  }\n']);return ie=function(){return e},e}var ue=Object(b.gql)(ie()),me=function(){var e=w({query:ue,initialState:{CategoryFind:[]}}).data;return!1===Object(i.c)(function(e){return e.auth.isLoggedIn})?null:r.a.createElement("aside",{className:"col-sm-12 col-md-3"},r.a.createElement(p,{categories:e.CategoryFind}))},de=function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{className:"nav-link",to:"/"},"Home")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{className:"nav-link",to:"/category/search"},"Search Category")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{className:"nav-link",to:"/category/goods"},"Search Goods")))))};function ge(){return r.a.createElement("div",{className:"App"},r.a.createElement(i.a,{store:ce},r.a.createElement(o.a,null,r.a.createElement(de,null),r.a.createElement("main",{className:"row"},r.a.createElement(me,null),r.a.createElement("div",{className:"col-sm-12 col-md-9"},r.a.createElement(s.d,null,ee.map(function(e,t){return e.isProtected?r.a.createElement(se,Object.assign({key:t.toString()},e)):r.a.createElement(s.b,Object.assign({key:t.toString()},e))})))))))}a(49);var pe=document.getElementById("root");l.a.render(r.a.createElement(ge,null),pe)}},[[31,1,2]]]);
//# sourceMappingURL=main.447c57f3.chunk.js.map